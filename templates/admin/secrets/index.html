{% extends 'admin/layout.html' %}

{% block body %}

    <h1>Secrets for project {{ project.name }}</h1>

    <div>
        <a class="pure-button" onclick="appendNewSecret()">+</a>
    </div>
    <div>
        <br />
        <br />
    </div>

    <div>
        <div class="pure-controls">
            <button onclick="secretsForm().submit()" class="pure-button pure-button-primary">Save</button>
        </div>
        <form class="pure-form pure-g" id="main-form-secrets" method="post" enctype="application/x-www-form-urlencoded">

        </form>
    </div>

    <script>
        function secretsForm() {
            return document.getElementById('main-form-secrets');
        }

        function appendNewSecret(name = '', value = '------') {
            const form = secretsForm();
            form.innerHTML = `
                <div class="pure-u-1-4">
                    <input name="secrets[new][name]" type="text" class="pure-input-1" placeholder="Secret name" value="${name}" />
                </div>
                <div class="pure-u-3-4">
                    <input name="secrets[new][value]" type="password" class="pure-input-1" placeholder="" value="--------" />
                </div>`
                + form.innerHTML;
        }

        {% for secret in secrets %}
            appendNewSecret('{{ secret.name }}');
        {% endfor %}
    </script>

{% endblock %}
